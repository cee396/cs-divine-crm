"use strict";(()=>{var e={};e.id=350,e.ids=[350],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3509:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>h,patchFetch:()=>y,requestAsyncStorage:()=>l,routeModule:()=>c,serverHooks:()=>g,staticGenerationAsyncStorage:()=>m});var r={};a.r(r),a.d(r,{GET:()=>u,dynamic:()=>d});var s=a(9303),n=a(8716),i=a(670),o=a(7070),p=a(2663);let d="force-dynamic";async function u(e){try{let{searchParams:t}=new URL(e.url),a=t.get("limit"),r=t.get("sort"),s=t.get("status"),n=t.get("search"),i=parseInt(t.get("page")||"1"),d=parseInt(t.get("pageSize")||"10"),u={};s&&"all"!==s&&(u.status=s),n&&(u.OR=[{ownerName:{contains:n,mode:"insensitive"}},{propertyAddress:{contains:n,mode:"insensitive"}},{county:{contains:n,mode:"insensitive"}},{ownerEmail:{contains:n,mode:"insensitive"}},{ownerPhone:{contains:n,mode:"insensitive"}}]);let c={createdAt:"desc"};"recent"===r?c={createdAt:"desc"}:"name"===r?c={ownerName:"asc"}:"status"===r&&(c={status:"asc"});let l=await p._.lead.count({where:u}),m=await p._.lead.findMany({where:u,orderBy:c,skip:a?0:(i-1)*d,take:a?parseInt(a):d,select:{id:!0,ownerName:!0,propertyAddress:!0,propertyCity:!0,propertyState:!0,propertyZip:!0,county:!0,status:!0,taxesOwed:!0,ownerPhone:!0,ownerEmail:!0,createdAt:!0,updatedAt:!0,priority:!0,contactAttempts:!0,lastContactDate:!0,nextFollowUpDate:!0,assessedValue:!0,marketValue:!0,yearsDelinquent:!0}});return o.NextResponse.json({leads:m,pagination:{page:i,pageSize:d,totalCount:l,totalPages:Math.ceil(l/d)}})}catch(e){return console.error("Error fetching leads:",e),o.NextResponse.json({error:"Failed to fetch leads"},{status:500})}}let c=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/leads/route",pathname:"/api/leads",filename:"route",bundlePath:"app/api/leads/route"},resolvedPagePath:"/home/ubuntu/cs-divine-crm/app/app/api/leads/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:l,staticGenerationAsyncStorage:m,serverHooks:g}=c,h="/api/leads/route";function y(){return(0,i.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:m})}},2663:(e,t,a)=>{a.d(t,{_:()=>s});let r=require("@prisma/client"),s=globalThis.prisma??new r.PrismaClient}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[276,972],()=>a(3509));module.exports=r})();